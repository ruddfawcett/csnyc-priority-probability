/*!
* jQuery Scrollbox
* (c) 2009-2013 Hunter Wu <hunter.wu@gmail.com>
* MIT Licensed.
*
* http://github.com/wmh/jquery-scrollbox
*/
(function(a){a.fn.scrollbox=function(b){var c={linear:false,startDelay:2,delay:3,step:5,speed:32,switchItems:1,direction:"vertical",distance:"auto",autoPlay:true,onMouseOverPause:true,paused:false,queue:null,listElement:"ul",listItemElement:"li",infiniteLoop:true,switchAmount:0,afterForward:null,afterBackward:null,triggerStackable:false};b=a.extend(c,b);b.scrollOffset=b.direction==="vertical"?"scrollTop":"scrollLeft";if(b.queue){b.queue=a("#"+b.queue)}return this.each(function(){var d=a(this),i,j=null,f=null,q=false,e,r,k,h,o,m,p,l,g=0,n=0;if(b.onMouseOverPause){d.bind("mouseover",function(){q=true});d.bind("mouseout",function(){q=false})}i=d.children(b.listElement+":first-child");if(b.infiniteLoop===false&&b.switchAmount===0){b.switchAmount=i.children().length}o=function(){if(q){return}var v,t,u,s,w;v=i.children(b.listItemElement+":first-child");s=b.distance!=="auto"?b.distance:b.direction==="vertical"?v.outerHeight(true):v.outerWidth(true);if(!b.linear){w=Math.max(3,parseInt((s-d[0][b.scrollOffset])*0.3,10));u=Math.min(d[0][b.scrollOffset]+w,s)}else{u=Math.min(d[0][b.scrollOffset]+b.step,s)}d[0][b.scrollOffset]=u;if(u>=s){for(t=0;t<b.switchItems;t++){if(b.queue&&b.queue.find(b.listItemElement).length>0){i.append(b.queue.find(b.listItemElement)[0]);i.children(b.listItemElement+":first-child").remove()}else{i.append(i.children(b.listItemElement+":first-child"))}++g}d[0][b.scrollOffset]=0;clearInterval(j);j=null;if(a.isFunction(b.afterForward)){b.afterForward.call(d,{switchCount:g,currentFirstChild:i.children(b.listItemElement+":first-child")})}if(b.triggerStackable&&n!==0){e();return}if(b.infiniteLoop===false&&g>=b.switchAmount){return}if(b.autoPlay){f=setTimeout(k,b.delay*1000)}}};m=function(){if(q){return}var v,t,u,s,w;if(d[0][b.scrollOffset]===0){for(t=0;t<b.switchItems;t++){i.children(b.listItemElement+":last-child").insertBefore(i.children(b.listItemElement+":first-child"))}v=i.children(b.listItemElement+":first-child");s=b.distance!=="auto"?b.distance:b.direction==="vertical"?v.height():v.width();d[0][b.scrollOffset]=s}if(!b.linear){w=Math.max(3,parseInt(d[0][b.scrollOffset]*0.3,10));u=Math.max(d[0][b.scrollOffset]-w,0)}else{u=Math.max(d[0][b.scrollOffset]-b.step,0)}d[0][b.scrollOffset]=u;if(u===0){--g;clearInterval(j);j=null;if(a.isFunction(b.afterBackward)){b.afterBackward.call(d,{switchCount:g,currentFirstChild:i.children(b.listItemElement+":first-child")})}if(b.triggerStackable&&n!==0){e();return}if(b.autoPlay){f=setTimeout(k,b.delay*1000)}}};e=function(){if(n===0){return}if(n>0){n--;f=setTimeout(k,0)}else{n++;f=setTimeout(r,0)}};k=function(){clearInterval(j);j=setInterval(o,b.speed)};r=function(){clearInterval(j);j=setInterval(m,b.speed)};p=function(){b.autoPlay=true;q=false;clearInterval(j);j=setInterval(o,b.speed)};l=function(){q=true};h=function(s){b.delay=s||b.delay;clearTimeout(f);if(b.autoPlay){f=setTimeout(k,b.delay*1000)}};if(b.autoPlay){f=setTimeout(k,b.startDelay*1000)}d.bind("resetClock",function(s){h(s)});d.bind("forward",function(){if(b.triggerStackable){if(j!==null){n++}else{k()}}else{clearTimeout(f);k()}});d.bind("backward",function(){if(b.triggerStackable){if(j!==null){n--}else{r()}}else{clearTimeout(f);r()}});d.bind("pauseHover",function(){l()});d.bind("forwardHover",function(){p()});d.bind("speedUp",function(s,t){if(t==="undefined"){t=Math.max(1,parseInt(b.speed/2,10))}b.speed=t});d.bind("speedDown",function(s,t){if(t==="undefined"){t=b.speed*2}b.speed=t});d.bind("updateConfig",function(t,s){b=a.extend(b,s)})})}}(jQuery));